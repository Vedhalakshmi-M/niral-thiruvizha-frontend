<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaf Nitrogen & Soil Predictor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
       @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

body {
    font-family: 'Poppins', sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
    background: linear-gradient(to bottom, #dff6dd, #a0e3a0);
    color: #2c3e50;
}

.container {
    background: white;
    border-radius: 12px;
    padding: 20px;
    width: 50%;
    margin: auto;
    box-shadow: 4px 4px 15px rgba(0, 0, 0, 0.1);
    margin-top: 20px;
    transition: 0.3s;
}

.container:hover {
    transform: scale(1.02);
}

button {
    padding: 12px 20px;
    font-size: 16px;
    font-weight: bold;
    background-color: #28a745;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 8px;
    transition: background 0.3s, transform 0.2s;
}

button:hover {
    background-color: #218838;
    transform: scale(1.05);
}

button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}

input[type="text"], input[type="file"] {
    padding: 12px;
    width: 80%;
    margin: 10px 0;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 16px;
    font-family: 'Poppins', sans-serif;
}

input[type="text"]:focus {
    border-color: #28a745;
    outline: none;
}

#imagePreview {
    max-width: 300px;
    margin-top: 20px;
    display: none;
    border: 1px solid #ddd;
    padding: 5px;
    border-radius: 8px;
    box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
}

.info-box {
    text-align: left;
    margin-top: 20px;
    padding: 15px;
    border-radius: 10px;
    background-color: #f9f9f9;
    border-left: 5px solid #28a745;
    font-size: 16px;
    transition: 0.3s;
}

.info-box:hover {
    background-color: #eaf9e5;
}

h2 {
    font-size: 24px;
    font-weight: bold;
    color: #155724;
}

    </style>
</head>
<body>

    <h2 id="title-header">üå± Intelligent Farming : AI-Based Soil & Leaf Nutrient Prediction System üåç</h2>

    <!-- üåç Language Selector -->
    <label for="language" id="lang-label">üåç Choose Language:</label>
    <select id="language" onchange="changeLanguage()">
        <option value="en">English</option>
        <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)</option>
        <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
    </select>
    <br><br>

    <!-- üì∏ Leaf Image Upload -->
    <div class="container">
        <h3 id="upload-title">üì∏ Upload Leaf Image for Nitrogen Level Prediction</h3>
        <input type="file" id="fileInput" accept="image/*">
        <br><br>
        <img id="imagePreview" src="" alt="Uploaded Image">
        <br>
        <button onclick="uploadImage()" disabled id="predictBtn">Predict Nitrogen Level</button>
        <h3 id="predictionResult"></h3>
        <div class="info-box" id="nitrogenSolution" style="display:none;"></div>
        <button onclick="startPredictVoice()" id="voice-predict-btn">üéôÔ∏è Voice: Predict Nitrogen</button>
        <button onclick="speakNitrogenSolution()" id="voice-nitrogen-btn">üéôÔ∏è Speak Solution</button>
    </div>
    </div>

    <br>

    <!-- üå§ Weather, Soil & Fertilization -->
    <div class="container">
        <h3 id="weather-title">üå§ Get Weather & Soil Information</h3>
        <input type="text" id="cityInput" placeholder="Enter City Name">
        <button onclick="fetchData()" id="get-data-btn">Get Data</button>
        <button onclick="startCityVoiceRecognition()" id="voice-city-btn">üéôÔ∏è Speak City Name</button>
        <div class="info-box">
            <h4 id="weather-header">Weather Data:</h4>
            <p id="weather">Enter a city to get weather data.</p>
            <h4 id="soil-header">Soil Data:</h4>
            <p id="soil">Enter a city to get soil data.</p>
            <h4 id="fertilizer-header">Fertilizer Recommendations:</h4>
            <p id="fertilizer">Enter a city to get fertilizer recommendations.</p>
            <button onclick="speakFertilizer()" id="voice-fertilizer-btn">üéôÔ∏è Speak Fertilizer Recommendations</button>
        </div>
        <h3>üîÑ Past Searches</h3>
        <div id="pastSearches" class="info-box">
            <p>Loading past searches...</p>
        </div>
        </div>
        <button onclick="downloadReport()" id="download-btn">üìÑ Download Report</button>
    </div>

    <script>
        const fileInput = document.getElementById("fileInput");
        const imagePreview = document.getElementById("imagePreview");
        const predictBtn = document.getElementById("predictBtn");

        fileInput.addEventListener("change", function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = "block";
                    predictBtn.disabled = false;
                };
                reader.readAsDataURL(file);
            }
        });

        function uploadImage() {
            const file = fileInput.files[0];
            if (!file) {
                alert("Please select an image first!");
                return;
            }

            const formData = new FormData();
            formData.append("file", file);

            fetch("http://127.0.0.1:5000/predict", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("predictionResult").innerHTML = 
                    `Predicted Class: <strong>${data.predicted_class}</strong> <br> Confidence: <strong>${data.confidence.toFixed(2)}%</strong>`;
                showNitrogenSolution(data.predicted_class);
            })
            .catch(error => {
                console.error("Error:", error);
                alert("‚ùå Failed to get prediction. Make sure the Flask server is running!");
            });
        }

        function fetchData() {
    const city = document.getElementById("cityInput").value;
    const lang = document.getElementById("language").value;
    fetch("http://127.0.0.1:5000/get_data", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ city: city, lang: lang })  
})
.then(response => response.json())
.then(data => {
    console.log("üü¢ Received Data:", data);  // ‚úÖ Debugging: Log API response

    // ‚úÖ Weather Data
    if (data.weather && data.weather.titles) {
            document.getElementById("weather").innerHTML = `
                <strong>${data.weather.titles.temperature}:</strong> ${data.weather.temperature}¬∞C <br>
                <strong>${data.weather.titles.humidity}:</strong> ${data.weather.humidity}% <br>
                <strong>${data.weather.titles.condition}:</strong> ${data.weather.condition}
            `;
        } else {
            document.getElementById("weather").innerHTML = "‚ùå Weather Data Not Available!";
        }

    // ‚úÖ Fix for Soil Data
    if (data.soil && data.soil.soil_data) {  
        let soilInfo = data.soil.soil_data;
        document.getElementById("soil").innerHTML = `
            <strong>${data.soil.titles.soil_type}:</strong> ${soilInfo["Soil Type"]} <br>
            <strong>${data.soil.titles.pH}:</strong> ${soilInfo["pH"]} <br>
            <strong>${data.soil.titles.nutrients}:</strong><br>
            - <strong>${data.soil.titles.nitrogen}:</strong> ${soilInfo["Nitrogen"]} <br>
            - <strong>${data.soil.titles.phosphorus}:</strong> ${soilInfo["Phosphorus"]} <br>
            - <strong>${data.soil.titles.potassium}:</strong> ${soilInfo["Potassium"]}
        `;
    } else {
        document.getElementById("soil").innerHTML = "‚ùå No Soil Data Found!";
    }

    // ‚úÖ Fertilizer Recommendations
    if (data.soil && data.soil.fertilizer_recommendations.length > 0) {
        document.getElementById("fertilizer").innerHTML = `
            <strong>${data.soil.titles.fertilizer_recommendations}:</strong> <br>
            ${data.soil.fertilizer_recommendations.join(", ")}
        `;
    }
})
.catch(error => {
    console.error("‚ùå Error fetching data:", error);
    alert("Failed to fetch data. Check console for errors.");
});


}

        function speakNitrogenSolution() {
            let lang = document.getElementById("language").value;
            let solutionText = document.getElementById("nitrogenSolution").innerText;
            speakText(solutionText, lang);
        }

        function speakFertilizer() {
            let lang = document.getElementById("language").value;
            let fertilizerText = document.getElementById("fertilizer").innerText;
            speakText(fertilizerText, lang);
        }

        function startPredictVoice() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = "en-US";
            recognition.start();

            recognition.onresult = function(event) {
                const command = event.results[0][0].transcript.toLowerCase();
                if (command.includes("predict nitrogen")) {
                    uploadImage();
                }
            };
        }

        function startCityVoiceRecognition() {
            let lang = document.getElementById("language").value;
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            
            if (lang === "ta") {
                recognition.lang = "ta-IN"; // Tamil
            } else if (lang === "hi") {
                recognition.lang = "hi-IN"; // Hindi
            } else {
                recognition.lang = "en-US"; // English
            }

            recognition.start();

            recognition.onresult = function(event) {
                const cityName = event.results[0][0].transcript;
                document.getElementById("cityInput").value = cityName;
                fetchData();
            };
        }
       /* function speakText(text, lang) {
            const synth = window.speechSynthesis;
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = synth.getVoices();

            if (lang === "ta") {
            utterance.lang = "ta-IN"; // Tamil
            utterance.voice = voices.find(voice => voice.lang === "ta-IN") || voices[0];
        } else if (lang === "hi") {
            utterance.lang = "hi-IN"; // Hindi
            utterance.voice = voices.find(voice => voice.lang === "hi-IN") || voices[0];
        } else {
            utterance.lang = "en-US"; // Default English
            utterance.voice = voices.find(voice => voice.lang === "en-US") || voices[0];
        }

        synth.speak(utterance);
    }*/
    function speakText(text, lang) {
    let languageCode = lang; // Default to provided language code

    // Convert Tamil & Hindi to Google TTS-supported language codes
    if (lang === "ta") {
        languageCode = "ta"; // Tamil
    } else if (lang === "hi") {
        languageCode = "hi"; // Hindi
    } else {
        languageCode = "en"; // English
    }

    let googleTTSUrl = `https://translate.google.com/translate_tts?ie=UTF-8&tl=${languageCode}&client=tw-ob&q=${encodeURIComponent(text)}`;
    
    let audio = new Audio(googleTTSUrl);
    audio.play();
}
async function downloadReport() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Load custom Tamil and Hindi fonts
    const tamilFont = await fetch("https://cdn.jsdelivr.net/gh/googlefonts/noto-fonts/unhinted/NotoSansTamil-Regular.ttf").then(res => res.arrayBuffer());
    const hindiFont = await fetch("https://cdn.jsdelivr.net/gh/googlefonts/noto-fonts/unhinted/NotoSansDevanagari-Regular.ttf").then(res => res.arrayBuffer());

    // Add fonts to jsPDF
    doc.addFileToVFS("NotoSansTamil.ttf", tamilFont);
    doc.addFont("NotoSansTamil.ttf", "NotoSansTamil", "normal");

    doc.addFileToVFS("NotoSansDevanagari.ttf", hindiFont);
    doc.addFont("NotoSansDevanagari.ttf", "NotoSansDevanagari", "normal");

    // Get the selected language
    let lang = document.getElementById("language").value;
    
    if (lang === "ta") {
        doc.setFont("NotoSansTamil");
    } else if (lang === "hi") {
        doc.setFont("NotoSansDevanagari");
    } else {
        doc.setFont("helvetica"); // Default font for English
    }

    // Set Font Size
    doc.setFontSize(18);
    doc.text("üå± Leaf Nitrogen & Soil Report", 20, 20);

    // üì∏ Nitrogen Prediction
    const predictionResult = document.getElementById("predictionResult").innerText;
    doc.setFontSize(14);
    doc.text("üì∏ Nitrogen Prediction:", 20, 40);
    doc.setFontSize(12);
    doc.text(predictionResult || "No prediction available", 20, 50, { maxWidth: 170 });

    // üå§ Weather Data
    const weatherData = document.getElementById("weather").innerText;
    doc.setFontSize(14);
    doc.text("üå§ Weather Data:", 20, 70);
    doc.setFontSize(12);
    doc.text(weatherData || "No weather data available", 20, 80, { maxWidth: 170 });

    // üå± Soil Data
    const soilData = document.getElementById("soil").innerText;
    doc.setFontSize(14);
    doc.text("üå± Soil Data:", 20, 100);
    doc.setFontSize(12);
    doc.text(soilData || "No soil data available", 20, 110, { maxWidth: 170 });

    // üåæ Fertilizer Recommendations
    const fertilizerData = document.getElementById("fertilizer").innerText;
    doc.setFontSize(14);
    doc.text("üåæ Fertilizer Recommendations:", 20, 130);
    doc.setFontSize(12);
    doc.text(fertilizerData || "No recommendations available", 20, 140, { maxWidth: 170 });

    // Save PDF
    doc.save("Leaf_Nitrogen_Soil_Report.pdf");
}





    function showNitrogenSolution(level) {
        let lang = document.getElementById("language").value;
        let translation = translations[lang];

        document.getElementById("nitrogenSolution").innerHTML = `
            <strong>${translation["solution-title"]}:</strong> ${translation["nitrogenSolutions"][level] || translation["no_recommendation"]}
        `;
        document.getElementById("nitrogenSolution").style.display = "block";
    }
        const translations = {
            en: {
                "title-header": "üå± Intelligent Farming : AI-Based Soil & Leaf Nutrient Prediction System",
                "lang-label": "üåç Choose Language:",
                "upload-title": "üì∏ Upload Leaf Image for Nitrogen Level Prediction",
                "predictBtn": "Predict Nitrogen Level",
                "weather-title": "üå§ Get Weather & Soil Information",
                "get-data-btn": "Get Data",
                "weather-header": "Weather Data:",
                "soil-header": "Soil Data:",
                "fertilizer-header": "Fertilizer Recommendations:",
                "download-btn": "üìÑ Download Report",
                "voice-predict-btn": "üéôÔ∏è Voice: Predict Nitrogen",
                "voice-nitrogen-btn": "üéôÔ∏è Speak Solution",
                "voice-city-btn": "üéôÔ∏è Speak City Name",
                "voice-fertilizer-btn": "üéôÔ∏è Speak Fertilizer Recommendations",
                "fileInput": "Choose file",
                "cityInput": "Enter city name",
                "weather": "Enter city name to get weather data",
                "soil": "Enter city name to get soil data", 
                "fertilizer": "Enter city name to get fertilizer recommendations",
                "solution-title": "Solution",
                "pdf_filename": "Leaf_Nitrogen_Soil_Report.pdf",
                "no_prediction": "No prediction available",
                "no_weather": "No weather data available",
                "no_soil": "No soil data available",
                "no_fertilizer": "No recommendations available",
                "no_recommendation": "No recommendation available",
                "nitrogenSolutions": {
                    "Low_Nitrogen": "Apply Urea or Organic Manure. Water properly to avoid nutrient loss.",
                    "Medium_Nitrogen": "Maintain current levels. Use balanced compost.",
                    "Medium_High_Nitrogen": "Balance nitrogen with phosphorus-based fertilizers like DAP.",
                    "High_Nitrogen": "Reduce nitrogen fertilizers. Apply potassium sulfate for better plant balance."
                }
            },
            ta: {
                "title-header": "üå± ‡Æá‡Æ≤‡Øà ‡Æ®‡Øà‡Æü‡Øç‡Æ∞‡Æú‡Æ©‡Øç & ‡ÆÆ‡Æ£‡Øç ‡Æï‡Æ£‡Æø‡Æ™‡Øç‡Æ™‡Ææ‡Æ≥‡Æ∞‡Øç üåç",
                "lang-label": "üåç ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà ‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡Æï:",
                "upload-title": "üì∏ ‡Æá‡Æ≤‡Øà ‡Æ™‡Æü‡Æ§‡Øç‡Æ§‡Øà ‡Æ™‡Æ§‡Æø‡Æµ‡Øá‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç ‡Æ®‡Øà‡Æü‡Øç‡Æ∞‡Æú‡Æ©‡Øç ‡Æ®‡Æø‡Æ≤‡Øà‡ÆØ‡Øà ‡Æï‡Æ£‡Æø‡Æï‡Øç‡Æï",
                "predictBtn": "‡Æ®‡Øà‡Æü‡Øç‡Æ∞‡Æú‡Æ©‡Øç ‡Æï‡Æ£‡Æø‡Æï‡Øç‡Æï",
                "weather-title": "üå§ ‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡Æ£‡Øç ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç",
                "get-data-btn": "‡Æ§‡Æ∞‡Æµ‡Øà‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "weather-header": "‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç:",
                "soil-header": "‡ÆÆ‡Æ£‡Øç ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç:",
                "fertilizer-header": "‡Æâ‡Æ∞ ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øç:",
                "download-btn": "üìÑ ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà‡ÆØ‡Øà‡Æ™‡Øç ‡Æ™‡Æ§‡Æø‡Æµ‡Æø‡Æ±‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "voice-predict-btn": "üéôÔ∏è ‡Æï‡ØÅ‡Æ∞‡Æ≤‡Øç: ‡Æ®‡Øà‡Æü‡Øç‡Æ∞‡Æú‡Æ©‡Øç ‡Æï‡Æ£‡Æø‡Æï‡Øç‡Æï",
                "voice-nitrogen-btn": "üéôÔ∏è ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æµ‡Øà ‡Æ™‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "voice-city-btn": "üéôÔ∏è ‡Æ®‡Æï‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà ‡Æ™‡Øá‡Æö‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "voice-fertilizer-btn": "üéôÔ∏è ‡Æâ‡Æ∞ ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øà ‡Æï‡ØÇ‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "fileInput": "‡Æï‡Øã‡Æ™‡Øç‡Æ™‡Øà ‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "cityInput": "‡Æ®‡Æï‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "weather": "‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡Æ§‡Æ∞‡Æµ‡ØÅ‡Æï‡Æ≥‡Øà ‡Æ™‡ØÜ‡Æ± ‡Æ®‡Æï‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "soil": "‡ÆÆ‡Æ£‡Øç ‡Æ§‡Æ∞‡Æµ‡ØÅ‡Æï‡Æ≥‡Øà ‡Æ™‡ØÜ‡Æ± ‡Æ®‡Æï‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç",  // ‚úÖ New
                "fertilizer": "‡Æâ‡Æ∞ ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øà ‡Æ™‡ØÜ‡Æ± ‡Æ®‡Æï‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç",
                "solution-title": "‡Æ§‡ØÄ‡Æ∞‡Øç‡Æµ‡ØÅ",
                "pdf_filename": "‡Æá‡Æ≤‡Øà_‡Æ®‡Øà‡Æü‡Øç‡Æ∞‡Æú‡Æ©‡Øç_‡ÆÆ‡Æ£‡Øç_‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà.pdf",
                "no_prediction": "‡Æ§‡Æï‡Æµ‡Æ≤‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà",
                "no_weather": "‡Æï‡Ææ‡Æ≤‡Æ®‡Æø‡Æ≤‡Øà ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà",
                "no_soil": "‡ÆÆ‡Æ£‡Øç ‡Æ§‡Æï‡Æµ‡Æ≤‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà",
                "no_fertilizer": "‡Æâ‡Æ∞ ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà",
                 "no_recommendation": "‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà",
                "nitrogenSolutions": {
                    "Low_Nitrogen": "‡ÆØ‡ØÇ‡Æ∞‡Æø‡ÆØ‡Ææ ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æï‡Æ∞‡Æø‡ÆÆ ‡Æâ‡Æ∞‡ÆÆ‡Øç ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç.",
                    "Medium_Nitrogen": "‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡Øà‡ÆØ ‡ÆÖ‡Æ≥‡Æµ‡Øà‡Æ™‡Øç ‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
                    "Medium_High_Nitrogen": "DAP ‡Æ™‡Øã‡Æ©‡Øç‡Æ± ‡Æ™‡Ææ‡Æ∏‡Øç‡Æ™‡Æ∞‡Æ∏‡Øç ‡Æâ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç.",
                    "High_Nitrogen": "‡Æ®‡Øà‡Æü‡Øç‡Æ∞‡Æú‡Æ©‡Øç ‡Æâ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æï‡ØÅ‡Æ±‡Øà‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç."
                }
            },
            hi: {
                "title-header": "üå± ‡§™‡§§‡•ç‡§§‡•á ‡§®‡§æ‡§á‡§ü‡•ç‡§∞‡•ã‡§ú‡§® ‡§î‡§∞ ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§µ‡§ï‡•ç‡§§‡§æ üåç",
                "lang-label": "üåç ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç:",
                "upload-title": "üì∏ ‡§™‡§§‡•ç‡§§‡•á ‡§ï‡•Ä ‡§õ‡§µ‡§ø ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç",
                "predictBtn": "‡§®‡§æ‡§á‡§ü‡•ç‡§∞‡•ã‡§ú‡§® ‡§ï‡•Ä ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§µ‡§æ‡§£‡•Ä ‡§ï‡§∞‡•á‡§Ç",
                "weather-title": "üå§ ‡§Æ‡•å‡§∏‡§Æ ‡§î‡§∞ ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç",
                "get-data-btn": "‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç",
                "weather-header": "‡§Æ‡•å‡§∏‡§Æ ‡§°‡•á‡§ü‡§æ:",
                "soil-header": "‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§°‡•á‡§ü‡§æ:",
                "fertilizer-header": "‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç:",
                "download-btn": "üìÑ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç",
                "voice-predict-btn": "üéôÔ∏è ‡§Ü‡§µ‡§æ‡§ú‡§º: ‡§®‡§æ‡§á‡§ü‡•ç‡§∞‡•ã‡§ú‡§® ‡§ï‡•Ä ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§µ‡§æ‡§£‡•Ä ‡§ï‡§∞‡•á‡§Ç",
                "voice-nitrogen-btn": "üéôÔ∏è ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§∏‡•Å‡§®‡•á‡§Ç",
                "voice-city-btn": "üéôÔ∏è ‡§∂‡§π‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¨‡•ã‡§≤‡•á‡§Ç",
                "voice-fertilizer-btn": "üéôÔ∏è ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç ‡§∏‡•Å‡§®‡•á‡§Ç",
                "fileInput": "‡§´‡§º‡§æ‡§á‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç",
                "cityInput": "‡§∂‡§π‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç",
                "weather": "‡§Æ‡•å‡§∏‡§Æ ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡§π‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç",
                "soil": "‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡§π‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç",  // ‚úÖ New
                "fertilizer": "‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡§π‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç" ,
                "solution-title": "‡§∏‡§Æ‡§æ‡§ß‡§æ‡§®",
                "pdf_filename": "‡§™‡§§‡•ç‡§§‡§æ_‡§®‡§æ‡§á‡§ü‡•ç‡§∞‡•ã‡§ú‡§®_‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä_‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü.pdf",
                "no_prediction": "‡§ï‡•ã‡§à ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§µ‡§æ‡§£‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç",
                "no_weather": "‡§ï‡•ã‡§à ‡§Æ‡•å‡§∏‡§Æ ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç",
                "no_soil": "‡§ï‡•ã‡§à ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç",
                "no_fertilizer": "‡§ï‡•ã‡§à ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç",
                "no_recommendation": "‡§ï‡•ã‡§à ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç",
                "nitrogenSolutions": {
                    "Low_Nitrogen": "‡§Ø‡•Ç‡§∞‡§ø‡§Ø‡§æ ‡§Ø‡§æ ‡§ú‡•à‡§µ‡§ø‡§ï ‡§ñ‡§æ‡§¶ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§",
                    "Medium_Nitrogen": "‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§∏‡•ç‡§§‡§∞ ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ‡•á‡§Ç‡•§",
                    "Medium_High_Nitrogen": "‡§°‡•Ä‡§è‡§™‡•Ä ‡§ú‡•à‡§∏‡•á ‡§´‡§æ‡§∏‡•ç‡§´‡•ã‡§∞‡§∏ ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§",
                    "High_Nitrogen": "‡§®‡§æ‡§á‡§ü‡•ç‡§∞‡•ã‡§ú‡§® ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï‡•ã‡§Ç ‡§ï‡•ã ‡§ï‡§Æ ‡§ï‡§∞‡•á‡§Ç‡•§"
                }
            }
        };

        function changeLanguage() {
            let lang = document.getElementById("language").value;
            for (let key in translations[lang]) {
                if (document.getElementById(key)) {
                    document.getElementById(key).innerText = translations[lang][key];
                }
            }
            document.getElementById("fileInput").setAttribute("title", translations[lang]["fileInput"]);
            document.getElementById("cityInput").setAttribute("placeholder", translations[lang]["cityInput"]);
            if (document.getElementById("cityInput").value) {
              fetchData();  // ‚úÖ Re-fetch data to update weather section
    }
    }
    document.addEventListener("DOMContentLoaded", changeLanguage);

        

        //document.getElementById("title-header").innerText = translations[lang]["title-header"];
            //document.getElementById("lang-label").innerText = translations[lang]["lang-label"];
            //document.getElementById("upload-title").innerText = translations[lang]["upload-title"];
            //document.getElementById("predictBtn").innerText = translations[lang]["predictBtn"];
            //document.getElementById("weather-title").innerText = translations[lang]["weather-title"];
            //document.getElementById("get-data-btn").innerText = translations[lang]["get-data-btn"];
            //document.getElementById("weather-header").innerText = translations[lang]["weather-header"];
            //document.getElementById("soil-header").innerText = translations[lang]["soil-header"];
            //document.getElementById("fertilizer-header").innerText = translations[lang]["fertilizer-header"];
            //document.getElementById("download-btn").innerText = translations[lang]["download-btn"];
            window.speechSynthesis.onvoiceschanged = function () {
        console.log("Voices loaded:", speechSynthesis.getVoices());
    };

    function fetchPastSearches() {
    fetch("http://127.0.0.1:5000/get_past_searches")
    .then(response => response.json())
    .then(data => {
        let pastSearchesContainer = document.getElementById("pastSearches");
        pastSearchesContainer.innerHTML = "<h4>Past Searches:</h4>";

        if (data.past_searches.length === 0) {
            pastSearchesContainer.innerHTML += "<p>No past searches found.</p>";
            return;
        }

        data.past_searches.forEach(search => {
            let searchEntry = `<div class="search-entry">
                <strong>City:</strong> ${search.city} <br>
                <strong>Date:</strong> ${new Date(search.timestamp).toLocaleString()} <br>
                <strong>Temperature:</strong> ${search.weather.temperature}¬∞C <br>
                <strong>Soil Type:</strong> ${search.soil.soil_data["Soil Type"]} <br>
                <hr>
            </div>`;
            pastSearchesContainer.innerHTML += searchEntry;
        });
    })
    .catch(error => console.error("Error fetching past searches:", error));
}

// Fetch past searches when page loads
document.addEventListener("DOMContentLoaded", fetchPastSearches);


    </script>

</body>
</html>
